/*** Directives and services for responding to idle users in AngularJS
* @author Mike Grabski <me@mikegrabski.com>
* @version v0.3.5
* @link https://github.com/HackedByChinese/ng-idle.git
* @license MIT
*/
!function(a,b){"use strict";function c(){var a={http:null,interval:600};this.http=function(c){if(!c)throw new Error("Argument must be a string containing a URL, or an object containing the HTTP request configuration.");b.isString(c)&&(c={url:c,method:"GET"}),c.cache=!1,a.http=c};var c=this.interval=function(b){if(b=parseInt(b),isNaN(b)||0>=b)throw new Error("Interval must be expressed in seconds and be greater than 0.");a.interval=b};this.$get=["$rootScope","$log","$interval","$http",function(d,e,f,g){function h(a,b){d.$broadcast("$keepaliveResponse",a,b)}function i(){d.$broadcast("$keepalive"),b.isObject(a.http)&&g(a.http).success(h).error(h)}var j={ping:null};return{_options:function(){return a},setInterval:c,start:function(){return f.cancel(j.ping),j.ping=f(i,1e3*a.interval),j.ping},stop:function(){f.cancel(j.ping)},ping:function(){i()}}}]}function d(){var a={idleDuration:1200,warningDuration:30,autoResume:!0,events:"mousemove keydown DOMMouseScroll mousewheel mousedown touchstart touchmove",keepalive:!0};this.activeOn=function(b){a.events=b},this.idleDuration=function(b){if(0>=b)throw new Error("idleDuration must be a value in seconds, greater than 0.");a.idleDuration=b},this.warningDuration=function(b){if(0>b)throw new Error("warning must be a value in seconds, greater than 0.");a.warningDuration=b},this.autoResume=function(b){a.autoResume=b===!0},this.keepalive=function(b){a.keepalive=b===!0},this.$get=["$interval","$log","$rootScope","$document","$keepalive",function(b,c,d,e,f){function g(){a.keepalive&&(l.running&&f.ping(),f.start())}function h(){a.keepalive&&f.stop()}function i(){l.idling=!l.idling;var c=l.idling?"Start":"End";d.$broadcast("$idle"+c),l.idling?(h(),l.countdown=a.warningDuration,j(),l.warning=b(j,1e3,a.warningDuration,!1)):g(),b.cancel(l.idle)}function j(){return l.countdown<=0?void k():(d.$broadcast("$idleWarn",l.countdown),void l.countdown--)}function k(){h(),b.cancel(l.idle),b.cancel(l.warning),l.idling=!0,l.running=!1,l.countdown=0,d.$broadcast("$idleTimeout")}var l={idle:null,warning:null,idling:!1,running:!1,countdown:null},m={_options:function(){return a},_getNow:function(){return new Date},isExpired:function(){return l.expiry&&l.expiry<=this._getNow()},running:function(){return l.running},idling:function(){return l.idling},watch:function(){b.cancel(l.idle),b.cancel(l.warning),l.expiry=new Date((new Date).getTime()+1e3*(a.idleDuration+a.warningDuration)),l.idling?i():l.running||g(),l.running=!0,l.idle=b(i,1e3*a.idleDuration,0,!1)},unwatch:function(){b.cancel(l.idle),b.cancel(l.warning),l.idling=!1,l.running=!1,l.expiry=null},interrupt:function(){return l.running?this.isExpired()?void k():void(a.autoResume&&this.watch()):void 0}};return e.find("body").on(a.events,function(){m.interrupt()}),m}]}b.module("ngIdle.keepalive",[]).provider("$keepalive",c),b.module("ngIdle.idle",[]).provider("$idle",d),b.module("ngIdle.ngIdleCountdown",[]).directive("ngIdleCountdown",function(){return{restrict:"A",scope:{value:"=ngIdleCountdown"},link:function(a){a.$on("$idleWarn",function(b,c){a.value=c}),a.$on("$idleTimeout",function(){a.value=0})}}}),b.module("ngIdle",["ngIdle.keepalive","ngIdle.idle","ngIdle.ngIdleCountdown"])}(window,window.angular);
//# sourceMappingURL=angular-idle.map